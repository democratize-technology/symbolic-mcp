# SPDX-License-Identifier: MIT
# Copyright (c) 2025 Symbolic MCP Contributors

# Comprehensive Dependabot Configuration for Symbolic-MCP
# Security-focused automated dependency updates for symbolic execution platform

version: 2
registries:
  # PyPI registry configuration
  pypi:
    type: python-index
    url: https://pypi.org/simple

updates:
  # === CORE PYTHON DEPENDENCIES ===
  # Core MCP framework and symbolic execution dependencies
  - package-ecosystem: "pip"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "tuesday"
      time: "09:00"
      timezone: "UTC"
    open-pull-requests-limit: 10
    reviewers:
      - "jpwoody"
    assignees:
      - "jpwoody"
    commit-message:
      prefix: "deps"
      include: "scope"
    labels:
      - "dependencies"
      - "python"
      - "security"
      - "core"
    allow:
      # Allow updates for core symbolic execution dependencies
      - dependency-name: "fastmcp*"
        dependency-type: "production"
      - dependency-name: "crosshair-tool*"
        dependency-type: "production"
      - dependency-name: "z3-solver*"
        dependency-type: "production"
      - dependency-name: "icontract*"
        dependency-type: "production"
      - dependency-name: "RestrictedPython*"
        dependency-type: "production"
      - dependency-name: "typing-extensions*"
        dependency-type: "production"
      - dependency-name: "pydantic*"
        dependency-type: "production"
      - dependency-name: "psutil*"
        dependency-type: "production"
    ignore:
      # Maintain stability for critical symbolic execution components
      - dependency-name: "fastmcp"
        update-types: ["version-update:semver-major"]
      - dependency-name: "z3-solver"
        update-types: ["version-update:semver-major"]
      - dependency-name: "crosshair-tool"
        update-types: ["version-update:semver-major"]
      - dependency-name: "RestrictedPython"
        update-types: ["version-update:semver-major"]
    groups:
      # Group core dependencies to reduce PR noise
      core-symbolic-execution:
        patterns:
          - "fastmcp*"
          - "crosshair-tool*"
          - "z3-solver*"
        dependency-type: "production"
      core-security:
        patterns:
          - "RestrictedPython*"
          - "icontract*"
        dependency-type: "production"
      core-utilities:
        patterns:
          - "typing-extensions*"
          - "pydantic*"
          - "psutil*"
        dependency-type: "production"

  # === DEVELOPMENT DEPENDENCIES ===
  # Testing, linting, and development tools
  - package-ecosystem: "pip"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "thursday"
      time: "09:00"
      timezone: "UTC"
    open-pull-requests-limit: 5
    reviewers:
      - "jpwoody"
    commit-message:
      prefix: "deps"
      include: "scope"
    labels:
      - "dependencies"
      - "python"
      - "development"
      - "tooling"
    allow:
      # Allow updates for development dependencies
      - dependency-name: "pytest*"
        dependency-type: "development"
      - dependency-name: "black"
        dependency-type: "development"
      - dependency-name: "flake8"
        dependency-type: "development"
      - dependency-name: "isort"
        dependency-type: "development"
      - dependency-name: "mypy"
        dependency-type: "development"
      - dependency-name: "bandit"
        dependency-type: "development"
      - dependency-name: "safety"
        dependency-type: "development"
    groups:
      testing-framework:
        patterns:
          - "pytest*"
        dependency-type: "development"
      code-quality:
        patterns:
          - "black"
          - "flake8"
          - "isort"
          - "mypy"
        dependency-type: "development"
      security-tools:
        patterns:
          - "bandit"
          - "safety"
        dependency-type: "development"

  # === PRODUCTION DEPENDENCIES ===
  # Production monitoring and logging (optional)
  - package-ecosystem: "pip"
    directory: "/"
    schedule:
      interval: "monthly"
      day: "monday"
      time: "09:00"
      timezone: "UTC"
    open-pull-requests-limit: 3
    reviewers:
      - "jpwoody"
    commit-message:
      prefix: "deps"
      include: "scope"
    labels:
      - "dependencies"
      - "python"
      - "production"
      - "monitoring"
    allow:
      - dependency-name: "structlog*"
        dependency-type: "production"
      - dependency-name: "prometheus-client*"
        dependency-type: "production"
      - dependency-name: "pydantic-settings*"
        dependency-type: "production"
    groups:
      production-observability:
        patterns:
          - "structlog*"
          - "prometheus-client*"
        dependency-type: "production"

  # === EXPERIMENTAL DEPENDENCIES ===
  # Research features and advanced symbolic execution tools
  - package-ecosystem: "pip"
    directory: "/"
    schedule:
      interval: "monthly"
      day: "friday"
      time: "09:00"
      timezone: "UTC"
    open-pull-requests-limit: 2
    reviewers:
      - "jpwoody"
    commit-message:
      prefix: "deps"
      include: "scope"
    labels:
      - "dependencies"
      - "python"
      - "experimental"
      - "research"
    allow:
      - dependency-name: "angr*"
        dependency-type: "production"
      - dependency-name: "scikit-learn*"
        dependency-type: "production"
      - dependency-name: "numpy*"
        dependency-type: "production"
      - dependency-name: "ray*"
        dependency-type: "production"
    groups:
      symbolic-execution-research:
        patterns:
          - "angr*"
        dependency-type: "production"
      machine-learning:
        patterns:
          - "scikit-learn*"
          - "numpy*"
        dependency-type: "production"
      distributed-processing:
        patterns:
          - "ray*"
        dependency-type: "production"

  # === GITHUB ACTIONS DEPENDENCIES ===
  # CI/CD pipeline and security scanning dependencies
  - package-ecosystem: "github-actions"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "tuesday"
      time: "10:00"
      timezone: "UTC"
    open-pull-requests-limit: 5
    reviewers:
      - "jpwoody"
    commit-message:
      prefix: "ci"
      include: "scope"
    labels:
      - "dependencies"
      - "github-actions"
      - "ci-cd"
      - "automation"
    groups:
      core-actions:
        patterns:
          - "actions/checkout"
          - "actions/setup-python"
          - "actions/upload-artifact"
          - "actions/download-artifact"
      security-actions:
        patterns:
          - "actions/github-script"
    allow:
      # Allow updates for GitHub Actions used in this repository
      - dependency-name: "actions/checkout*"
      - dependency-name: "actions/setup-python*"
      - dependency-name: "actions/cache*"
      - dependency-name: "actions/upload-artifact*"
      - dependency-name: "actions/download-artifact*"
      - dependency-name: "actions/github-script*"
    # Auto-merge minor GitHub Actions updates for security
    auto-merge-level: "minor"

  # === SECURITY-FOCUSED UPDATES ===
  # High-frequency security dependency monitoring
  - package-ecosystem: "pip"
    directory: "/"
    schedule:
      interval: "daily"
      time: "06:00"
      timezone: "UTC"
    open-pull-requests-limit: 3
    reviewers:
      - "jpwoody"
    assignees:
      - "jpwoody"
    commit-message:
      prefix: "security"
      include: "scope"
    labels:
      - "dependencies"
      - "python"
      - "security"
      - "critical"
      - "auto-merge"
    # Auto-merge security updates for minor/patch versions
    auto-merge-level: "patch"
    allow:
      # Focus on security-critical dependencies
      - dependency-name: "bandit*"
        dependency-type: "production"
      - dependency-name: "safety*"
        dependency-type: "production"
      - dependency-name: "RestrictedPython*"
        dependency-type: "production"
      - dependency-name: "pydantic*"
        dependency-type: "production"
    # Only allow patch and minor updates for security-critical deps
    update-types: ["version-update:semver-patch", "version-update:semver-minor"]

  # === DOCKER DEPENDENCIES ===
  # Base image updates for containerized deployments
  - package-ecosystem: "docker"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "wednesday"
      time: "09:00"
      timezone: "UTC"
    open-pull-requests-limit: 2
    reviewers:
      - "jpwoody"
    commit-message:
      prefix: "docker"
      include: "scope"
    labels:
      - "dependencies"
      - "docker"
      - "infrastructure"
    allow:
      # Python base images
      - dependency-name: "python*"
      - dependency-name: "ubuntu*"
    ignore:
      # Ignore major version updates for stability
      - dependency-name: "python"
        update-types: ["version-update:semver-major"]

# === GLOBAL CONFIGURATION ===
# Apply to all dependency updates
commit-message:
  prefix: "deps"
  prefix-development: "chore"
  include: "scope"

# Maximum number of open pull requests per ecosystem
open-pull-requests-limit: 20

# Pull request settings
pull-request-branch-name:
  separator: "/"

# Version constraints to maintain stability
versioning-strategy:
  # Use lockfile-only updates for stability
  update-types: ["version-update:semver-patch", "version-update:semver-minor"]

# Exclusion lists for stability-critical dependencies
# Note: Specific exclusions are handled in each update section above
# to provide granular control over different dependency categories
